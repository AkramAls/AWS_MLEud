# Operationalizing Machine Learning on SageMaker by Akram Al-Selwadi

## Initial Setup

I'm using the default SageMaker instance ml.t3.medium when Notebook Instances are created for my notebook as I will be only running the notebook only when working on the project, and I do not need a CPU or RAM more than that judging from the file size that is provided and the goals for the project. I was having issues getting my code to store the downloaded data to the S3 bucket, because I was doing it though Jupyter and not Jupyter labs.
![Screenshot 2024-10-18 at 14-09-26 Notebook instances Amazon SageMaker us-east-1](https://github.com/user-attachments/assets/8ba902f7-e32b-45a3-8fd0-f1059941d7c6)

S3 Bucket with the dataset
![Screenshot 2024-10-19 at 13-33-48 opmlimagebucket - S3 bucket S3 us-east-1](https://github.com/user-attachments/assets/5a37ff41-6f7d-4933-b6e7-8cbca4d3ce75)

For tuning I used ml.m5.2xlarge for the greater processing power so that the tuning job and training jobs could be completed more quickly and to avoid memory issues I had experienced when working with this dataset in a previous project. For training instances, I set ``instance_count=4``and kept most parameters the same.

I had some problems with AWS, which required me to start over. This time I was able to load the data to S3 and launch the endpoints. The single and multi endpoints can be found below.

  Single instance trained endpoint: ``pytorch-inference-2024-10-19-19-00-50-543``
  
  Multi instance trained endpoint: ``pytorch-inference-2024-10-19-19-22-45-799``
![Screenshot 2024-10-19 at 15-28-40 Endpoints Amazon SageMaker us-east-1](https://github.com/user-attachments/assets/d11aa842-0e8d-4891-861a-cd95bce2094f)

Deep Learning OSS Nvidia Driver AMI GPU PyTorch 2.3.1 (Amazon Linux 2), but had issues with the CUDA version that runs so I reinstall PyTorch with the correct CUDA Version.

To uninstall current version of PyTorch:

```pip uninstall torch torchvision torchaudio -y```

To reinstall PyTorch with the appropriate CUDA version:

```pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118```
```
{
  "statusCode": 200,
  "headers": {
    "Content-Type": "text/plain",
    "Access-Control-Allow-Origin": "*"
  },
  "type-result": "<class 'str'>",
  "COntent-Type-In": "<__main__.LambdaContext object at 0x7fdb48dee070>",
  "body": "[[-9.096986770629883, -6.280696392059326, -3.6407206058502197, -1.623978614807129, -4.52439022064209, -5.167107105255127, -2.9249727725982666, -2.8705129623413086, -7.8250532150268555, -1.5073524713516235, -1.95694100856781, -4.514562606811523, -0.32904502749443054, 0.6669425368309021, -5.567157745361328, -3.9589951038360596, -8.504964828491211, -2.159571886062622, -3.857482433319092, 1.6533637046813965, -6.385259628295898, -3.1520373821258545, -8.131010055541992, -7.660277843475342, -6.443761348724365, -10.485486030578613, -5.250019073486328, -6.405547618865967, -8.258563995361328, -0.5176408290863037, -6.320932388305664, -4.718957901000977, -8.405498504638672, -7.335566520690918, -10.348310470581055, -6.9180426597595215, -7.017837047576904, -0.6434236764907837, -2.468348264694214, -8.042801856994629, -3.815700054168701, -2.242116689682007, 2.4018771648406982, -6.806573867797852, -0.5093210339546204, -9.101749420166016, -5.03752326965332, 1.5559486150741577, -5.102183818817139, -2.6244912147521973, -3.957767963409424, -9.652307510375977, -9.861614227294922, -3.170854330062866, -7.720099449157715, -2.309325695037842, -6.728293418884277, -6.596529006958008, -2.1687183380126953, -2.528806447982788, -7.449897289276123, -9.91438102722168, -11.869610786437988, -10.103141784667969, -3.306910276412964, -9.012389183044434, 1.470926284790039, -6.440833568572998, -2.6904876232147217, -1.164985179901123, -0.08895723521709442, -8.30551528930664, -5.315221786499023, -4.130455493927002, -6.954455375671387, -2.6175105571746826, -12.292277336120605, -2.981276512145996, -7.856142520904541, -4.847909450531006, -0.07831322401762009, -8.176919937133789, -1.3720309734344482, -2.4301841259002686, -10.431918144226074, -7.048996448516846, -1.7571501731872559, -10.699981689453125, -4.15992546081543, -2.192228078842163, -11.052444458007812, -7.7356672286987305, -6.310140132904053, -8.986392974853516, -7.390171051025391, -2.5930705070495605, -4.329840183258057, -4.918014049530029, -9.226435661315918, -4.837480545043945, -8.597445487976074, -2.8956727981567383, -6.596631050109863, -3.817946434020996, -6.6799492835998535, -10.64243221282959, -1.2400000095367432, 0.7482686638832092, -3.1552622318267822, 1.8327558040618896, -0.9535248279571533, -2.2177162170410156, -11.003973007202148, -7.895530700683594, -8.497802734375, -2.8575565814971924, -8.964386940002441, -0.7265918850898743, -8.964128494262695, -0.8830686211585999, -4.121635437011719, -5.214657783508301, -4.111880779266357, -7.8513360023498535, -8.24428653717041, -7.469294548034668, -3.6901681423187256, -1.780672311782837, -5.731601715087891, -9.206201553344727, -6.329228401184082, -2.2607877254486084, -4.914355754852295]]"
}```
